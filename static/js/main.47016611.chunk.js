(this.webpackJsonpsyndicate20=this.webpackJsonpsyndicate20||[]).push([[0],{57:function(e){e.exports=JSON.parse('[{"id":"1","img":"1"},{"id":"2","img":"2"},{"id":"3","img":"3"},{"id":"4","img":"4"},{"id":"4","img":"5"}]')},64:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),c=n(25),s=n.n(c),a="hashedData",o=":".concat(a),u={MAIN:"/syndicate20-public/",USER_CHOOSE_RESULTS:"".concat("/syndicate20-public","/results/:").concat(a)};var h,f=n(26),j=Object(f.a)();!function(e){e.REJECT="reject",e.SELECT="select"}(h||(h={}));var l=n(31),d=n(4),m=n(5),b=function(){function e(){Object(d.a)(this,e),this.cache=null,this.storage=window.localStorage}return Object(m.a)(e,[{key:"setUserChoise",value:function(e){var t=this;return this.getUserChoiseData().then((function(n){return t.setData(n||[],e)}))}},{key:"getUserChoiseData",value:function(){var t=this.getFromCache();if(t)return Promise.resolve(t);var n=this.storage.getItem(e.KEY);if(n)try{var r=JSON.parse(n);return Promise.resolve(r)}catch(i){return Promise.resolve(null)}return Promise.resolve(null)}},{key:"setData",value:function(t,n){var r=[].concat(Object(l.a)(t),[n]);try{var i=JSON.stringify(r);try{return this.storage.setItem(e.KEY,i),this.setToCache(r),Promise.resolve(!0)}catch(c){return Promise.resolve(!1)}}catch(c){return Promise.resolve(!1)}}},{key:"getFromCache",value:function(){return this.cache}},{key:"setToCache",value:function(e){this.cache=e}}]),e}();b.KEY="data";var v=new b,O=n(33),g=new(function(){function e(){Object(d.a)(this,e),this.fingerprintJS=Object(O.a)(),this.userFingerprint=""}return Object(m.a)(e,[{key:"getFingerPrint",value:function(){var e=this;return this.userFingerprint?Promise.resolve(this.userFingerprint):this.fingerprintJS.then((function(t){return t.get().then((function(t){return e.userFingerprint=t.visitorId,e.userFingerprint}))}))}}]),e}()),p=n(27),C=n.n(p),x=new(function(){function e(){Object(d.a)(this,e),this.instance=C.a.create()}return Object(m.a)(e,[{key:"get",value:function(e,t){return this.instance.get(e,t).then((function(e){return e.data}))}},{key:"post",value:function(e,t,n){return this.instance.post(e,t,n).then((function(e){return e.data}))}}]),e}()),E=n(57),S=new(function(){function e(){Object(d.a)(this,e)}return Object(m.a)(e,[{key:"sendUserForm",value:function(e,t){var n={fingerPrint:e,userChoiceData:t};return x.post("",n)}},{key:"getItems",value:function(){return Promise.resolve(E)}}]),e}());function w(e){var t=function(e){var t=JSON.stringify(e);return window.btoa(t)}(e);return"".concat(window.location.hostname).concat(function(e){return u.USER_CHOOSE_RESULTS.replace(o,e)}(t))}var y=n(32);var k=n(30),I=Object(k.a)({display:"flex"}),F=n(1);function U(e){var t=e.item,n=e.onChoose,r=i.a.useCallback((function(){return n(t,h.SELECT)}),[t,n]),c=i.a.useCallback((function(){return n(t,h.REJECT)}),[t,n]);return Object(F.jsxs)("div",{className:I,children:[Object(F.jsx)("div",{children:"id: ".concat(t.id," - img: ").concat(t.img)}),!t.swipe&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("button",{onClick:r,children:"\u0412\u042b\u0411\u0420\u0410\u0422\u042c"}),Object(F.jsx)("button",{onClick:c,children:"\u041e\u0422\u0412\u0415\u0420\u0413\u041d\u0423\u0422\u042c"})]})]})}var J=n(8),T=n(66),P=new(function(){function e(){var t=this;Object(d.a)(this,e),this.items$=new T.a([]),this.handleChooseItem=function(e,n){var r=Object(J.a)(Object(J.a)({},e),{},{swipe:n});v.setUserChoise(r).then((function(n){if(n){var i=t.items$.getValue().map((function(t){return t===e?r:t}));t.items$.next(i)}}))},this.sendItems=function(){v.getUserChoiseData().then((function(e){e&&g.getFingerPrint().then((function(t){var n=w(e);S.sendUserForm(t,n)}))}))}}return Object(m.a)(e,[{key:"getItems",value:function(){var e=this;S.getItems().then((function(t){v.getUserChoiseData().then((function(n){if(n){var r=t.map((function(e){var t=n.find((function(t){return t.id===e.id&&t.img===e.img}));return t||Object(J.a)(Object(J.a)({},e),{},{swipe:null})}));e.items$.next(r)}else{var i=t.map((function(e){return Object(J.a)(Object(J.a)({},e),{},{swipe:null})}));e.items$.next(i)}}))}))}}]),e}());function R(){var e=function(e){var t=Object(r.useState)((function(){return e.getValue()})),n=Object(y.a)(t,2),i=n[0],c=n[1];return Object(r.useEffect)((function(){var t=e.subscribe((function(e){return c(e)}));return function(){return t.unsubscribe()}}),[e]),i}(P.items$);i.a.useEffect((function(){P.getItems()}),[]);var t={selected:[],rejected:[],other:[]};return e.forEach((function(e){e.swipe||t.other.push(e),e.swipe===h.SELECT&&t.selected.push(e),e.swipe===h.REJECT&&t.rejected.push(e)})),e.length?Object(F.jsxs)("div",{children:[Object(F.jsx)("p",{children:"\u041d\u0435\u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),t.other.map((function(e){return Object(F.jsx)(U,{item:e,onChoose:P.handleChooseItem},"".concat(e.id,"-").concat(e.img))})),Object(F.jsx)("p",{children:"\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),t.selected.map((function(e){return Object(F.jsx)(U,{item:e,onChoose:P.handleChooseItem},"".concat(e.id,"-").concat(e.img))})),Object(F.jsx)("p",{children:"\u041e\u0442\u0432\u0435\u0440\u0433\u043d\u0443\u0442\u044b\u0435"}),t.rejected.map((function(e){return Object(F.jsx)(U,{item:e,onChoose:P.handleChooseItem},"".concat(e.id,"-").concat(e.img))})),Object(F.jsx)("div",{children:Object(F.jsx)("button",{onClick:P.sendItems,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443"})})]}):Object(F.jsx)(F.Fragment,{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u0430"})}var D=n(7);function N(){var e=Object(D.d)().hashedData;if(!e)return Object(F.jsx)(F.Fragment,{});var t=function(e){var t=window.atob(e);return JSON.parse(t)}(e);return Object(F.jsxs)("div",{children:[Object(F.jsx)("p",{children:"\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),t.filter((function(e){return e.swipe===h.SELECT})).map((function(e){return Object(F.jsx)("div",{children:"id: ".concat(e.id," - img: ").concat(e.img)},e.id+e.img)})),Object(F.jsx)("p",{children:"\u041e\u0442\u0432\u0435\u0440\u0433\u043d\u0443\u0442\u044b\u0435"}),t.filter((function(e){return e.swipe===h.REJECT})).map((function(e){return Object(F.jsx)("div",{children:"id: ".concat(e.id," - img: ").concat(e.img)},e.id+e.img)}))]})}function L(){return Object(F.jsx)(D.b,{history:j,children:Object(F.jsxs)(D.c,{children:[Object(F.jsx)(D.a,{path:u.MAIN,exact:!0,component:R}),Object(F.jsx)(D.a,{path:u.USER_CHOOSE_RESULTS,component:N})]})})}s.a.render(Object(F.jsx)(i.a.StrictMode,{children:Object(F.jsx)(L,{})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.47016611.chunk.js.map